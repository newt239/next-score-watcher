# オンライン機能 残存タスク一覧

オンライン版Score Watcher機能で現在残っている実装タスクをまとめます。

## 概要

オンライン機能は**ほぼ完全に実装済み**です。基本的なゲーム機能（作成・設定・プレイ・表示）はすべて動作しており、実用レベルに達しています。

以下は、さらなる改善・最適化のための残存タスクです。

## 残存タスク一覧

### 🔴 高優先度タスク

#### 1. Discord Webhook機能（未実装）

**場所**: `/online/games/[game_id]/config`ページの設定項目  
**現状**: フォーム項目は存在するが機能は未実装  
**必要な実装**:

- ゲーム終了時の自動通知機能
- Webhook URL設定の保存・取得
- 通知メッセージのフォーマット設定
- エラーハンドリング（無効なURL、送信失敗など）

**実装ファイル**:

```
src/server/controllers/game/update-discord-webhook.ts  # 新規作成
src/models/games.ts                                    # スキーマ追加
src/app/(default)/online/games/[game_id]/config/_components/OtherConfig.tsx  # 既存修正
```

### 🟡 中優先度タスク（パフォーマンス・体験向上）

#### 2. WebSocketによるリアルタイム同期

**現状**: 2秒間隔のポーリングで動作（基本機能は問題なし）  
**改善効果**: レスポンス性向上、サーバー負荷軽減  
**必要な実装**:

- WebSocketサーバーの構築
- リアルタイム操作配信
- 接続状態の監視・復旧
- フォールバック機能（ポーリング）

#### 3. オフライン対応機能

**現状**: オンライン環境でのみ動作  
**改善効果**: ネットワーク不安定時の利便性向上  
**必要な実装**:

- オフライン操作のキューイング
- 復帰時の自動同期
- Service Workerによるキャッシュ
- 競合解決システム

#### 4. セキュリティ強化

**現状**: 基本的な認証・アクセス制御は実装済み  
**改善効果**: より安全な運用  
**必要な実装**:

- API認証の強化（Better Authセッション活用）
- レート制限機能
- セキュリティログ・監査機能
- 自動ログアウト機能

### 🟢 低優先度タスク（将来的な拡張）

#### 5. 高度な同期・競合解決

**対象**: 複数ユーザーが同時編集する場合の高度な制御  
**必要な実装**:

- Operational Transform
- 競合検出・解決UI
- 差分同期による最適化

#### 6. GDPR対応機能

**対象**: プライバシー・コンプライアンス強化  
**必要な実装**:

- ユーザーデータの完全削除機能
- データエクスポート機能
- データ暗号化機能

#### 7. 管理者機能

**対象**: 将来的なマルチユーザー対応  
**必要な実装**:

- ユーザーロール管理
- システム監視機能
- 一括データ管理機能

## 実装優先順位

### フェーズ1: 基本機能完成（高優先度）

1. **Discord Webhook機能** - 唯一の未実装基本機能

### フェーズ2: パフォーマンス向上（中優先度）

2. **WebSocketリアルタイム同期** - ユーザー体験の大幅改善
3. **セキュリティ強化** - 本格運用に向けた安全性確保
4. **オフライン対応** - 利便性向上

### フェーズ3: 高度な機能（低優先度）

5. **競合解決システム** - 複数ユーザー対応
6. **GDPR対応** - コンプライアンス強化
7. **管理者機能** - スケーラビリティ対応

## 現在の機能完成度

| 機能カテゴリ       | 完成度 | 備考                       |
| ------------------ | ------ | -------------------------- |
| ゲーム作成・管理   | 100%   | 完全実装済み               |
| プレイヤー管理     | 100%   | 完全実装済み               |
| クイズ管理         | 100%   | 完全実装済み               |
| ゲーム設定         | 100%   | 完全実装済み               |
| ボード表示・操作   | 100%   | 完全実装済み               |
| 基本同期機能       | 100%   | ポーリング方式で完全動作   |
| 認証・セキュリティ | 80%    | 基本機能は完成、強化が可能 |
| Discord連携        | 20%    | UI のみ、機能未実装        |
| リアルタイム同期   | 0%     | 現在はポーリング方式       |
| オフライン対応     | 0%     | オンライン専用             |

## まとめ

**現在の状況**: オンライン機能はほぼ完成しており、基本的なクイズゲームの運用には十分な機能を提供しています。

**即座に必要な作業**: Discord Webhook機能の実装のみです。

**改善の方向性**: パフォーマンス最適化（WebSocket）とセキュリティ強化に焦点を当てることで、より本格的なサービスレベルに到達できます。

**開発工数の見積もり**:

- Discord Webhook: 1-2日
- WebSocket同期: 1-2週間
- セキュリティ強化: 3-5日
- オフライン対応: 1-2週間
